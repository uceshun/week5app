var earthquakelayer,client,mymap,testMarkerRed,testMarkerPink,xhr;function setMarkers(){testMarkerRed=L.AwesomeMarkers.icon({icon:"play",markerColor:"red"}),testMarkerPink=L.AwesomeMarkers.icon({icon:"play",markerColor:"pink"})}function trackLocation(){navigator.geolocation?navigator.geolocation.watchPosition(showPosition):alert("geolocation is not supported by this browser")}function showPosition(e){L.marker([e.coords.latitude,e.coords.longitude]).addTo(mymap).bindPopup("<b>You were at "+e.coords.longitude+" "+e.coords.latitude+"!</b>"),mymap.setView([e.coords.latitude,e.coords.longitude],13)}function loadMap(){mymap=L.map("mapid").setView([51.505,-.09],13),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw",{maxZoom:18,attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',id:"mapbox.streets"}).addTo(mymap),trackLocation()}function showPointLineCircle(){L.marker([51.5,-.09]).addTo(mymap).bindPopup("<b>Hello world!</b><br />I am a popup.").openPopup(),L.circle([51.508,-.11],500,{color:"red",fillColor:"#f03",fillOpacity:.5}).addTo(mymap).bindPopup("I am a circle.");L.polygon([[51.509,-.08],[51.503,-.06],[51.51,-.047]],{color:"red",fillColor:"#f03",fillOpacity:.5}).addTo(mymap).bindPopup("I am a polygon.")}function getEarthquakes(){(client=new XMLHttpRequest).open("GET","http://developer.cege.ucl.ac.uk:30261/getGeoJSON/united_kingdom_highway/geom"),client.onreadystatechange=earthquakeResponse,client.send()}function earthquakeResponse(){4==client.readyState&&loadearthquakelayer(client.responseText)}function loadearthquakelayer(e){var o=JSON.parse(e),t=L.geoJson(o,{pointToLayer:function(e,o){return e.properties.mag>1.75?L.marker(o,{icon:testMarkerRed}).bindPopup("<b>"+e.properties.place+"</b>"):L.marker(o,{icon:testMarkerPink}).bindPopup("<b>"+e.properties.place+"</b>")}}).addTo(mymap);mymap.fitBounds(t.getBounds())}function showFormData(){(client=new XMLHttpRequest).open("GET","http://developer.cege.ucl.ac.uk:30261/getGeoJSON/formdata/geom"),client.onreadystatechange=formDataResponse,client.send()}function formDataResponse(){4==client.readyState&&loadFormDatalayer(client.responseText)}function loadFormDatalayer(e){var o=JSON.parse(e),t=L.geoJson(o,{pointToLayer:function(e,o){return"claire"==e.properties.name?L.marker(o,{icon:testMarkerRed}).bindPopup("<b>"+e.properties.name+"</b> "+e.properties.modulelist):L.marker(o,{icon:testMarkerPink}).bindPopup("<b>"+e.properties.place+"</b> "+e.properties.modulelist)}}).addTo(mymap);mymap.fitBounds(t.getBounds())}function callDivChange(){(xhr=new XMLHttpRequest).open("GET","http://developer.cege.ucl.ac.uk:30261/dir1/dir2/objectTest5.html"),xhr.onreadystatechange=processDivChange,xhr.send()}function processDivChange(){xhr.readyState<4||4===xhr.readyState&&(document.getElementById("ajaxtest").innerHTML=xhr.responseText)}!function(e,o,t){"use strict";L.AwesomeMarkers={},L.AwesomeMarkers.version="2.0.1",L.AwesomeMarkers.Icon=L.Icon.extend({options:{iconSize:[35,45],iconAnchor:[17,42],popupAnchor:[1,-32],shadowAnchor:[10,12],shadowSize:[36,16],className:"awesome-marker",prefix:"glyphicon",spinClass:"fa-spin",extraClasses:"",icon:"home",markerColor:"blue",iconColor:"white"},initialize:function(e){e=L.Util.setOptions(this,e)},createIcon:function(){var e=o.createElement("div"),t=this.options;return t.icon&&(e.innerHTML=this._createInner()),t.bgPos&&(e.style.backgroundPosition=-t.bgPos.x+"px "+-t.bgPos.y+"px"),this._setIconStyles(e,"icon-"+t.markerColor),e},_createInner:function(){var e,o="",t="",n="",r=this.options;return e=r.icon.slice(0,r.prefix.length+1)===r.prefix+"-"?r.icon:r.prefix+"-"+r.icon,r.spin&&"string"==typeof r.spinClass&&(o=r.spinClass),r.iconColor&&("white"===r.iconColor||"black"===r.iconColor?t="icon-"+r.iconColor:n="style='color: "+r.iconColor+"' "),"<i "+n+"class='"+r.extraClasses+" "+r.prefix+" "+e+" "+o+" "+t+"'></i>"},_setIconStyles:function(e,o){var t,n=this.options,r=L.point(n["shadow"===o?"shadowSize":"iconSize"]);!(t="shadow"===o?L.point(n.shadowAnchor||n.iconAnchor):L.point(n.iconAnchor))&&r&&(t=r.divideBy(2,!0)),e.className="awesome-marker-"+o+" "+n.className,t&&(e.style.marginLeft=-t.x+"px",e.style.marginTop=-t.y+"px"),r&&(e.style.width=r.x+"px",e.style.height=r.y+"px")},createShadow:function(){var e=o.createElement("div");return this._setIconStyles(e,"shadow"),e}}),L.AwesomeMarkers.icon=function(e){return new L.AwesomeMarkers.Icon(e)}}(0,document),loadMap(),setMarkers();var app={initialize:function(){this.bindEvents()},bindEvents:function(){document.addEventListener("deviceready",this.onDeviceReady,!1)},onDeviceReady:function(){app.receivedEvent("deviceready")},receivedEvent:function(e){var o=document.getElementById(e),t=o.querySelector(".listening"),n=o.querySelector(".received");t.setAttribute("style","display:none;"),n.setAttribute("style","display:block;"),console.log("Received Event: "+e)}};